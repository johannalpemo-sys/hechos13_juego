<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>La exhortaci√≥n de Pablo en Antioqu√≠a (3¬™. Parte) - Hechos 13:42-52</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f3f3f3;
        padding: 20px;
        text-align: center;
    }
    h1 { margin-bottom: 10px; font-size: 24px; }
    #timer { font-size: 22px; font-weight: bold; color: #d32f2f; }

    .container {
        display: flex;
        justify-content: space-around;
        margin-top: 30px;
        flex-wrap: wrap;
    }

    .dropzone {
        width: 40%;
        min-height: 250px;
        padding: 20px;
        border-radius: 10px;
        background: #fff;
        position: relative;
        box-sizing: border-box;
        border: 3px dashed #555;
    }

    #judios { background-color: #fde0dc; }  /* color para dificultad */
    #gentiles { background-color: #e0f7fa; } /* color para dificultad */

    .images {
        margin-top: 30px;
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
    }

    .item {
        width: 120px;
        height: 120px;
        border-radius: 10px;
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        cursor: grab;
        user-select: none;
        position: relative;
        font-size: 14px;
        text-align: center;
        padding: 5px;
        touch-action: none;
    }

    #versiculos {
        margin-top: 40px;
        padding: 20px;
        background: #fff;
        border-radius: 10px;
        text-align: left;
        width: 70%;
        margin-left: auto;
        margin-right: auto;
    }

    .marker {
        position: absolute;
        font-size: 24px;
        font-weight: bold;
        top: 0;
        right: 0;
        padding: 5px;
        border-radius: 50%;
    }

    /* Modal de mensaje de fin */
    #gameOverModal {
        display: none;
        position: fixed;
        top:0; left:0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.6);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        animation: fadeIn 0.5s;
    }

    #gameOverContent {
        background: #fff;
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        font-size: 24px;
        font-weight: bold;
        max-width: 500px;
        animation: popIn 0.5s;
    }

    @keyframes popIn {
        0% { transform: scale(0.5); opacity: 0; }
        100% { transform: scale(1); opacity: 1; }
    }

    @keyframes fadeIn {
        from { opacity: 0; } 
        to { opacity: 1; }
    }

    #gameOverContent button {
        margin-top: 20px;
        padding: 10px 20px;
        font-size: 18px;
        cursor: pointer;
        border: none;
        background: #1976d2;
        color: white;
        border-radius: 8px;
    }
</style>
</head>

<body>

<h1>La exhortaci√≥n de Pablo en Antioqu√≠a (3¬™. Parte)<br>
Regocijo y persecuci√≥n por la Palabra<br>
Hechos 13:42-52</h1>

<div id="timer">Tiempo: 60</div>

<h3>Arrastra cada reacci√≥n al grupo correcto</h3>

<div class="container">
    <div id="judios" class="dropzone" data-type="negativo">
        <h2>Jud√≠os</h2>
    </div>

    <div id="gentiles" class="dropzone" data-type="positivo">
        <h2>Gentiles</h2>
    </div>
</div>

<div class="images" id="imagenes">
    <div class="item" draggable="true" data-type="positivo" style="background:#4CAF50;">Regocijo</div>
    <div class="item" draggable="true" data-type="positivo" style="background:#1E88E5;">Glorificar la Palabra</div>
    <div class="item" draggable="true" data-type="positivo" style="background:#FDD835;">Fe</div>
    <div class="item" draggable="true" data-type="positivo" style="background:#FB8C00;">Gozo</div>

    <div class="item" draggable="true" data-type="negativo" style="background:#f44336;">Celos</div>
    <div class="item" draggable="true" data-type="negativo" style="background:#8E24AA;">Contradicci√≥n</div>
    <div class="item" draggable="true" data-type="negativo" style="background:#00ACC1;">Blasfemia</div>
    <div class="item" draggable="true" data-type="negativo" style="background:#D81B60;">Persecuci√≥n</div>
</div>

<!-- SONIDOS -->
<audio id="correctSound" src="correct.mp3"></audio>
<audio id="wrongSound" src="wrong.mp3"></audio>

<div id="versiculos">
    <h2>Vers√≠culos:</h2>
    <div id="versiculos-items"></div>
</div>

<!-- Modal de final de juego -->
<div id="gameOverModal">
    <div id="gameOverContent">
        <div id="gameOverText"></div>
        <button onclick="location.reload()">Jugar de nuevo</button>
    </div>
</div>

<script>
let items = document.querySelectorAll(".item");
let dropzones = document.querySelectorAll(".dropzone");
let totalItems = items.length;
let correctCount = 0;
let errorCount = 0;
let gameOver = false;

let timer = 60;
let timerElement = document.getElementById("timer");
let countdown = setInterval(() => {
    if(gameOver) return;
    timer--;
    timerElement.textContent = "Tiempo: " + timer;

    if (timer <= 0) {
        clearInterval(countdown);
        gameOver = true;
        finishGame();
    }
}, 1000);

// Vers√≠culos asociados
const versiculos = {
    "Regocijo": "Hechos 13:48 ‚Äî ‚ÄúLos gentiles, oyendo esto, se regocijaban y glorificaban la palabra del Se√±or.‚Äù",
    "Glorificar la Palabra": "Hechos 13:48 ‚Äî ‚ÄúLos gentiles, oyendo esto, se regocijaban y glorificaban la palabra del Se√±or.‚Äù",
    "Fe": "Hechos 13:48 ‚Äî ‚ÄúLos gentiles, oyendo esto, se regocijaban y glorificaban la palabra del Se√±or.‚Äù",
    "Gozo": "Hechos 13:52 ‚Äî ‚ÄúLos disc√≠pulos estaban llenos de gozo y del Esp√≠ritu Santo.‚Äù",
    "Celos": "Hechos 13:45 ‚Äî ‚ÄúPero los jud√≠os se llenaron de celos y contradijeron lo que Pablo dec√≠a.‚Äù",
    "Contradicci√≥n": "Hechos 13:45 ‚Äî ‚ÄúPero los jud√≠os se llenaron de celos y contradijeron lo que Pablo dec√≠a.‚Äù",
    "Blasfemia": "Hechos 13:45 ‚Äî ‚ÄúPero los jud√≠os se llenaron de celos y contradijeron lo que Pablo dec√≠a.‚Äù",
    "Persecuci√≥n": "Hechos 13:52 ‚Äî ‚ÄúLos disc√≠pulos estaban llenos de gozo y del Esp√≠ritu Santo.‚Äù"
};

// Drag and Drop compatible con touch y mouse
function makeDraggable(item) {
    // Mouse drag
    item.addEventListener("dragstart", e => {
        if(gameOver || item.dataset.locked === "true") e.preventDefault();
        e.dataTransfer.setData("type", item.dataset.type);
        e.dataTransfer.setData("text", item.innerText);
    });

    // Touch events
    item.addEventListener("touchstart", e => {
        if(gameOver || item.dataset.locked === "true") return;
        let touch = e.touches[0];
        item.style.position = "absolute";
        item.style.zIndex = 1000;
        moveAt(touch.pageX, touch.pageY);

        function moveAt(x, y) {
            item.style.left = x - item.offsetWidth/2 + 'px';
            item.style.top = y - item.offsetHeight/2 + 'px';
        }

        function onTouchMove(e) {
            let touch = e.touches[0];
            moveAt(touch.pageX, touch.pageY);
        }

        document.addEventListener("touchmove", onTouchMove);

        item.addEventListener("touchend", e => {
            document.removeEventListener("touchmove", onTouchMove);
            checkDrop(item);
        }, { once: true });
    });
}

items.forEach(item => makeDraggable(item));

dropzones.forEach(zone => {
    zone.addEventListener("dragover", e => e.preventDefault());
    zone.addEventListener("drop", e => { 
        e.preventDefault();
        const text = e.dataTransfer.getData("text");
        const itemType = e.dataTransfer.getData("type");
        let originalItem = [...document.querySelectorAll(".item")].find(i => i.innerText === text);
        if(originalItem) checkDrop(originalItem, zone);
    });
});

function checkDrop(item, zone=null) {
    if(!zone) {
        zone = item.dataset.type === "positivo" ? document.getElementById("gentiles") : document.getElementById("judios");
    }

    if(item.dataset.locked === "true") return;

    let marker = document.createElement("span");
    marker.className = "marker";

    if(item.dataset.type === zone.dataset.type) {
        marker.textContent = "‚úî";
        marker.style.color = "green";
        correctCount++;
        document.getElementById("correctSound").play();
    } else {
        marker.textContent = "‚úò";
        marker.style.color = "red";
        errorCount++;
        document.getElementById("wrongSound").play();
    }

    item.appendChild(marker);
    item.dataset.locked = "true";
    item.style.cursor = "default";
    item.style.position = "relative";
    zone.appendChild(item);

    // mostrar vers√≠culo inmediatamente
    let vContainer = document.getElementById("versiculos-items");
    let p = document.createElement("p");
    p.innerHTML = `<b>${item.innerText}:</b> ${versiculos[item.innerText]}`;
    vContainer.appendChild(p);

    // verificar si terminaron
    if((correctCount + errorCount) === totalItems) {
        gameOver = true;
        clearInterval(countdown);
        showGameOverModal();
    }
}

function finishGame() {
    items.forEach(item => item.dataset.locked = "true");
    items.forEach(item => {
        if(!item.parentNode.classList.contains("dropzone")) {
            let zone = item.dataset.type === "positivo" ? document.getElementById("gentiles") : document.getElementById("judios");
            checkDrop(item, zone);
        }
    });
}

function showGameOverModal() {
    let msg = "üéâ ¬°Juego completado! üéâ";
    if(errorCount > 0) msg += "<br>Hubo algunos errores. ¬°Repasa el texto y vuelve a intentarlo!";
    document.getElementById("gameOverText").innerHTML = msg;
    document.getElementById("gameOverModal").style.display = "flex";
}
</script>

</body>
</html>
